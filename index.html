<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Flappy Bird Valentine ‚ù§Ô∏è</title>
    <style>
      body {
        margin: 0;
        background: linear-gradient(#a0e7e5, #b4f8c8);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: "Segoe UI", sans-serif;
        overflow: hidden;
      }
      canvas {
        border: 3px solid #333;
        border-radius: 10px;
        background: linear-gradient(#87ceeb, #cce7ff);
      }
      #score {
        position: absolute;
        top: 10px;
        left: 10px;
        font-size: 24px;
        color: #ff4d6d;
        font-weight: bold;
      }
      #finalScreen {
        position: absolute;
        inset: 0;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: rgba(0, 0, 0, 0.8);
        color: #ff7eb3;
        font-size: 32px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div id="score">Score: 0</div>
    <div id="finalScreen">
      <h1>GirlName ‚ù§Ô∏è</h1>
      <p>
        You flew through all the obstacles!<br /><br />
        Will you be my Valentine today and forever? üíçüíñ
      </p>
    </div>

    <canvas id="game" width="500" height="500"></canvas>

    <script>
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");
      const scoreDisplay = document.getElementById("score");
      const finalScreen = document.getElementById("finalScreen");

      // Param√®tres
      const gravity = 0.4;
      const jump = -7;
      const scoreGoal = 10; // score n√©cessaire pour d√©clencher le message final
      let score = 0;
      let gameOver = false;

      const bird = {
        x: 80,
        y: 250,
        radius: 15,
        dy: 0,
      };

      const pipes = [];
      const pipeWidth = 50;
      const pipeGap = 180;
      let frameCount = 0;
      let gameStarted = false;

      // Contr√¥les
      window.addEventListener("keydown", (e) => {
        if (e.code === "Space") {
          bird.dy = jump;
          gameStarted = true;
          if (gameOver) {
            resetGame();
          }
        }
      });

      function resetGame() {
        bird.y = 250;
        bird.dy = 0;
        pipes.length = 0;
        score = 0;
        frameCount = 0;
        gameOver = false;
        gameStarted = false;
        finalScreen.style.display = "none";
      }

      // Dessiner l‚Äôoiseau avec c≈ìur
      function drawBird(x, y, radius) {
        ctx.fillStyle = "#FFD700";
        ctx.beginPath();
        ctx.arc(x, y, radius, 0, Math.PI * 2);
        ctx.fill();
        // Aile
        ctx.fillStyle = "#FFA500";
        ctx.beginPath();
        ctx.arc(x, y, radius * 0.6, 0, Math.PI, true);
        ctx.fill();
        // Oeil
        ctx.fillStyle = "#000";
        ctx.beginPath();
        ctx.arc(x + 5, y - 3, 3, 0, Math.PI * 2);
        ctx.fill();
        // Tag c≈ìur
        ctx.fillStyle = "#ff4d6d";
        ctx.beginPath();
        ctx.moveTo(x, y - radius - 5);
        ctx.bezierCurveTo(
          x + 5,
          y - radius - 15,
          x + 15,
          y - radius + 5,
          x,
          y - radius + 10,
        );
        ctx.bezierCurveTo(
          x - 15,
          y - radius + 5,
          x - 5,
          y - radius - 15,
          x,
          y - radius - 5,
        );
        ctx.fill();
      }

      // Dessiner tout
      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // Pipes
        ctx.fillStyle = "#ff7eb3";
        pipes.forEach((pipe) => {
          ctx.fillRect(pipe.x, 0, pipeWidth, pipe.topHeight);
          ctx.fillRect(
            pipe.x,
            pipe.topHeight + pipeGap,
            pipeWidth,
            canvas.height - (pipe.topHeight + pipeGap),
          );
        });
        // Bird
        drawBird(bird.x, bird.y, bird.radius);
      }

      // Mise √† jour
      function update() {
        if (!gameStarted) return;

        bird.dy += gravity;
        bird.y += bird.dy;

        frameCount++;

        // Pipes
        if (frameCount > 50 && frameCount % 140 === 0) {
          const topHeight = Math.floor(Math.random() * 200) + 50;
          pipes.push({ x: canvas.width, topHeight: topHeight, passed: false });
        }

        pipes.forEach((pipe, i) => {
          pipe.x -= 2;

          // Collision
          if (
            bird.x + bird.radius > pipe.x &&
            bird.x - bird.radius < pipe.x + pipeWidth
          ) {
            if (
              bird.y - bird.radius < pipe.topHeight ||
              bird.y + bird.radius > pipe.topHeight + pipeGap
            ) {
              resetGame(); // retourne au d√©but sans afficher le message
            }
          }

          // Score
          if (!pipe.passed && pipe.x + pipeWidth < bird.x) {
            score++;
            pipe.passed = true;
            // Afficher message final si score atteint
            if (score >= scoreGoal) {
              gameOver = true;
              finalScreen.style.display = "flex";
            }
          }

          if (pipe.x + pipeWidth < 0) {
            pipes.splice(i, 1);
          }
        });

        // Limites
        if (bird.y + bird.radius > canvas.height || bird.y - bird.radius < 0) {
          resetGame(); // retourne au d√©but sans afficher le message
        }

        scoreDisplay.textContent = `Score: ${score}`;
      }

      // Boucle
      function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
      }

      loop();
    </script>
  </body>
</html>
